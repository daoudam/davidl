!function(t,e,n,i){"use strict";var r={version:"0.0.1",settings:{donut:!1,donut_inner_ratio:.4,percent_offset:35,stroke_color:"#333",stroke_width:0,show_percent:!0,animation_speed:500,always_show_percent:!1,animation_type:"elastic"},init:function(e,i){var r=this;this.scope=e||n.body;var a=t("[data-pie-id]",this.scope);t.extend(!0,this.settings,i),a.length>0?a.each(function(){return r.build(t(this),i)}):this.build(t(this.scope),i),this.events()},events:function(){var n=this;t(e).off(".pizza").on("resize.pizza",n.throttle(function(){n.init()},100)),t(this.scope).off(".pizza").on("mouseenter.pizza mouseleave.pizza touchstart.pizza","[data-pie-id] li",function(e){var n=t(this).parent(),i=Snap(t("#"+n.data("pie-id")+' path[data-id="s'+t(this).index()+'"]')[0]),r=Snap(t(i.node).parent().find('text[data-id="'+i.node.getAttribute("data-id")+'"]')[0]),a=t(this).parent().data("settings");/start/i.test(e.type)&&t(i.node).siblings("path").each(function(){this.nodeName&&(i.animate({transform:"s1 1 "+i.node.getAttribute("data-cx")+" "+i.node.getAttribute("data-cy")},a.animation_speed,mina[a.animation_type]),Snap(t(this).next()[0]).animate({opacity:0},a.animation_speed))}),/enter|start/i.test(e.type)?(i.animate({transform:"s1.05 1.05 "+i.node.getAttribute("data-cx")+" "+i.node.getAttribute("data-cy")},a.animation_speed,mina[a.animation_type]),a.show_percent&&r.animate({opacity:1},a.animation_speed)):(i.animate({transform:"s1 1 "+i.node.getAttribute("data-cx")+" "+i.node.getAttribute("data-cy")},a.animation_speed,mina[a.animation_type]),r.animate({opacity:0},a.animation_speed))})},build:function(e,n){var i=this,r=e;return r.data("settings",t.extend({},i.settings,n,r.data("options"))),i.data(r,n||{}),i.update_DOM(i.pie(r))},data:function(e,n){var i=[];return t("li",e).each(function(){var e=t(this);i.push(n.data?{value:n.data[e.index()],color:e.css("color"),segment:e}:{value:e.data("value"),color:e.css("color"),segment:e})}),e.data("graph-data",i)},update_DOM:function(e){var n=e[0],i=e[1];return t(this.identifier(n)).html(i)},pie:function(e){for(var n=e.data("settings"),i=this.svg(e,n),r=e.data("graph-data"),a=0,o=[],s=0,l=t(this.identifier(e)).width()-4,u=0;u<r.length;u++)a+=r[u].value;for(var u=0;u<r.length;u++)o[u]=r[u].value/a*Math.PI*2;for(var u=0;u<r.length;u++){var c=s+o[u],f=l/2,d=l/2,h=l/2*.85;if(!n.donut){var p=f+h*Math.sin(s),g=d-h*Math.cos(s),m=f+h*Math.sin(c),v=d-h*Math.cos(c),y=0;c-s>Math.PI&&(y=1);var x="M"+f+","+d+" L"+p+","+g+" A"+h+","+h+" 0 "+y+" 1 "+m+","+v+" Z"}var b=t('path[data-id="s'+u+'"]',i.node);if(b.length>0)var _=Snap(b[0]);else var _=i.path();var w=r[u].value/a*100,C=t('text[data-id="s'+u+'"]',i.node);if(C.length>0){var k=Snap(C[0]);k.attr({x:f+(h+n.percent_offset)*Math.sin(s+o[u]/2),y:d-(h+n.percent_offset)*Math.cos(s+o[u]/2)})}else var k=_.paper.text(f+(h+n.percent_offset)*Math.sin(s+o[u]/2),d-(h+n.percent_offset)*Math.cos(s+o[u]/2),Math.ceil(w)+"%");var S=k.getBBox().width/2;k.attr(n.always_show_percent?{x:k.attr("x")-S,opacity:1}:{x:k.attr("x")-S,opacity:0}),k.node.setAttribute("data-id","s"+u),_.node.setAttribute("data-cx",f),_.node.setAttribute("data-cy",d),n.donut?this.annular_sector(_.node,{centerX:f,centerY:d,startDegrees:s,endDegrees:c,innerRadius:h*n.donut_inner_ratio,outerRadius:h}):_.attr({d:x}),_.attr({fill:r[u].color,stroke:n.stroke_color,strokeWidth:n.stroke_width}),_.node.setAttribute("data-id","s"+u),this.animate(_,f,d,n),s=c}return[e,i.node]},animate:function(e,n,i,r){e.hover(function(e){var a=Snap(e.target),o=Snap(t(a.node).parent().find('text[data-id="'+a.node.getAttribute("data-id")+'"]')[0]);a.animate({transform:"s1.05 1.05 "+n+" "+i},r.animation_speed,mina[r.animation_type]),o.touchend(function(){a.animate({transform:"s1.05 1.05 "+n+" "+i},r.animation_speed,mina[r.animation_type])}),r.show_percent&&(o.animate({opacity:1},r.animation_speed),o.touchend(function(){o.animate({opacity:1},r.animation_speed)}))},function(e){var a=Snap(e.target),o=Snap(t(a.node).parent().find('text[data-id="'+a.node.getAttribute("data-id")+'"]')[0]);a.animate({transform:"s1 1 "+n+" "+i},r.animation_speed,mina[r.animation_type]),o.animate({opacity:0},r.animation_speed)})},svg:function(e,n){var i=t(this.identifier(e)),r=t("svg",i),a=i.width(),o=a;return r=r.length>0?Snap(r[0]):Snap(a,o),r.node.setAttribute("width",a+n.percent_offset),r.node.setAttribute("height",o+n.percent_offset),r.node.setAttribute("viewBox","-"+n.percent_offset+" -"+n.percent_offset+" "+(a+1.5*n.percent_offset)+" "+(o+1.5*n.percent_offset)),r},annular_sector:function(t,e){function n(t){var e={cx:t.centerX||0,cy:t.centerY||0,startRadians:t.startDegrees||0,closeRadians:t.endDegrees||0},n=t.thickness!==i?t.thickness:100;return e.r1=t.innerRadius!==i?t.innerRadius:t.outerRadius!==i?t.outerRadius-n:200-n,e.r2=t.outerRadius!==i?t.outerRadius:e.r1+n,e.r1<0&&(e.r1=0),e.r2<0&&(e.r2=0),e}var r=n(e),a=[[r.cx+r.r2*Math.sin(r.startRadians),r.cy-r.r2*Math.cos(r.startRadians)],[r.cx+r.r2*Math.sin(r.closeRadians),r.cy-r.r2*Math.cos(r.closeRadians)],[r.cx+r.r1*Math.sin(r.closeRadians),r.cy-r.r1*Math.cos(r.closeRadians)],[r.cx+r.r1*Math.sin(r.startRadians),r.cy-r.r1*Math.cos(r.startRadians)]],o=r.closeRadians-r.startRadians,s=o%(2*Math.PI)>Math.PI?1:0,l=[];l.push("M"+a[0].join()),l.push("A"+[r.r2,r.r2,0,s,1,a[1]].join()),l.push("L"+a[2].join()),l.push("A"+[r.r1,r.r1,0,s,0,a[3]].join()),l.push("z"),t.setAttribute("d",l.join(" "))},identifier:function(t){return"#"+t.data("pie-id")},throttle:function(t,e){var n=null;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout(function(){t.apply(i,r)},e)}}};e.Pizza=r}($,this,this.document);